---
layout: post
title: "Custom real-time subscriptions"
date: 2025-11-06 01:00:00 +0900
description: >
  custom subscription 기능을 구현해야 하는 이유에 대한 설명입니다.
categories: [pick]
tags: [amplify, graphql]
---

## 채팅방 서비스에서 AWS Amplify 커스텀 Subscription을 구현해야 하는 이유

실시간 채팅방 서비스를 만들 때, AWS Amplify가 기본적으로 제공하는 모델 기반 subscription 기능만으로는 여러 한계점이 있다.

특히, 채팅방, 그룹, 유저별 이벤트 분리 등 복잡한 실시간 흐름이 필요한 경우 커스텀 subscription이 꼭 필요하다.

1. 서버 사이드 필터링과 이벤트 분리
   표준 subscription은 모든 메시지 변화를 브로드캐스트합니다. 즉, 모든 구독자가 모든 채팅방 메시지 이벤트를 받아서, 클라이언트에서 내 방 메시지만 직접 필터링해야 한다.

   커스텀 subscription은 서버에서 바로 채팅방별로 이벤트를 분리해줄 수 있습니다. 내가 속한 채팅방에만 해당하는 메시지(혹은 이벤트)만 직접 수신하므로, 네트워크/리소스 낭비 없이 최적의 실시간 동작을 구현할 수 있다.

2. 특정 Mutation/이벤트 기반 실시간 처리
   표준 subscription은 모델 단위로 생성/수정/삭제 이벤트만 처리한다.

   커스텀 subscription은 “메시지 읽음(read)”, “메시지 삭제(delete)” 등 특수 mutation이나 커스텀 이벤트 규칙도 자유롭게 실시간 처리할 수 있다.

3. 멀티 유저, 멀티 채널 실시간 분리
   여러 채팅방·유저가 동시에 서비스에 접속하는 환경에서, 표준 subscription으로는 전체 이벤트를 받고 클라이언트에서 불필요한 데이터 필터링을 하게 된다.

   커스텀 subscription은 채널·그룹·유저별로 구조적으로 subscription을 분리할 수 있어, 트래픽 및 클라이언트 효율성을 극대화할 수 있다.

4. 확장적인 권한 및 인증 제어
   표준 subscription의 owner 기반 권한은 한계가 있어 그룹 권한, 채널별 권한 등 세밀한 인증/인가가 어렵다.

   커스텀 subscription은 직접 인증 및 권한 로직을 구현하며, 유저·그룹 권한까지 자유롭게 제어/확장 가능하다.

5. 다양한 실시간 패턴 대응
   PubSub 구조, 알림, 복합 이벤트 패턴 등 실시간 서비스에 필요한 다양한 구조를 직접 설계할 수 있다.

정리:
복잡한 실시간 흐름, 효율적인 이벤트 분류, 세밀한 권한 관리, 다양한 mutation 처리와 확장성 등을 고려한다면 채팅방 서비스에서는 커스텀 subscription 구현이 필수적입니다. 이를 통해 서버에서 채팅방별로 실시간 이벤트를 최적화하고, 진짜 필요한 데이터만 구독자에게 전달함으로써 퍼포먼스와 확장성을 모두 잡을 수 있습니다.
